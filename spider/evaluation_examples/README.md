# 评估说明

本目录包含示例的金标准文件、预测文件和评估结果文件：

- `gold_example.txt`：金标准示例文件，每行格式为`标准SQL \t 数据库ID`
- `pred_example.txt`：预测示例文件，每行包含一个预测SQL语句
- `eval_result_example.txt`：评估结果示例文件

评估脚本会输出所有错误预测。最终评估分数可在结果文件底部查看。当前评估脚本不考虑`DISTINCT`关键字。

## 不同评估指标

我们的评估脚本包含以下指标：

### SQL难度分级标准

为更好理解模型在不同查询上的表现，我们将SQL查询分为4个难度等级：简单、中等、困难、极难。定义标准如下：

首先定义：
- SQL组件1：WHERE, GROUP BY, ORDER BY, LIMIT, JOIN, OR, LIKE, HAVING
- SQL组件2：EXCEPT, UNION, INTERSECT, NESTED（嵌套查询）
- 其他条件：聚合函数>1个，选择列>1个，WHERE条件>1个，GROUP BY子句>1个（不考虑col1-col2等数学表达式）

难度分级规则：
1. 简单：不包含[SQL组件2]，且满足以下任一：
   - 不含或仅含1个[SQL组件1]中的关键词
   - 不满足[其他条件]中任何一条
2. 中等：不包含[SQL组件2]，且满足以下任一：
   - 含≤2个[其他条件]且≤1个[SQL组件1]
   - 含2个[SQL组件1]且<2个[其他条件]
3. 困难：满足以下任一：
   - >2个[其他条件]且≤2个[SQL组件1]
   - 2<[SQL组件1]≤3个且≤2个[其他条件]
   - ≤1个[SQL组件1]且0个[其他条件]但含1个[SQL组件2]
4. 极难：其余所有情况
5. 全部：所有SQL-问题对参与评分

### 不考虑值的部分匹配

为评估模型在不同SQL组件上的表现，我们提供各部分的详细评分（当前评估不考虑值字符串匹配）。

评估以下10个组件的准确率和F1分数：
1. `SELECT列`（含聚合函数）
2. `SELECT列`（不含聚合函数）
3. `WHERE条件列`（含运算符）
4. `WHERE条件列`（不含运算符）
5. `GROUP BY`子句
6. `GROUP BY HAVING`子句
7. `ORDER BY`子句
8. `AND/OR`逻辑运算符
9. `EXCEPT/UNION/INTERSECT/嵌套SQL`特殊操作
10. `SQL关键词`集合匹配

### 不考虑值的精确匹配

为避免SQL组件顺序影响评估，我们不会直接比较整个SQL语句。而是：
1. 对每个组件进行集合匹配
2. 当预测SQL所有组件都正确时才得1分
（例如`SELECT col1,col2`和`SELECT col2,col1`将被视为相同）

### 执行准确率

虽然所有数据库都提供可执行的SQLite文件，但需注意执行结果可能产生假阳性（如不同语义的SQL可能返回相同NULL结果）。

当前模型暂不预测SQL条件中的具体值，因此不提供执行准确率。但鼓励后续提交包含：
- 可假设每个问题提供候选值列表（但预测列时不可使用这些值）
- 模型需将值填充到SQL的正确位置

（注：保留所有SQL关键词、专业术语和代码元素的英文原貌，仅对说明性文字进行本地化处理。技术术语如"F1分数"、"聚合函数"等采用中文计算机领域通用译法。）
